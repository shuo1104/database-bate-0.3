# PhotoPolymer é…æ–¹æ•°æ®åº“ - éƒ¨ç½²è¯´æ˜

## ğŸ“‹ å‰ç½®æ¡ä»¶

### 1. Pythonè™šæ‹Ÿç¯å¢ƒ
```bash
# è™šæ‹Ÿç¯å¢ƒå¿…é¡»ä½äºï¼š~/venv/database/
# å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒï¼š
python3 -m venv ~/venv/database
source ~/venv/database/bin/activate
cd backend_fastapi
pip install -r requirements.txt
```

### 2. å‰ç«¯æ„å»º
```bash
cd frontend_vue3
pnpm install
pnpm run build
```

### 3. æ–‡ä»¶æƒé™
```bash
# ç¡®ä¿nginxå¯ä»¥è®¿é—®é¡¹ç›®ç›®å½•
chmod 711 /home/xgs
chmod 755 /home/xgs/workspace
chmod 755 /home/xgs/workspace/database
chmod 755 /home/xgs/workspace/database/data_base
chmod 755 /home/xgs/workspace/database/data_base/frontend_vue3
chmod -R 755 /home/xgs/workspace/database/data_base/frontend_vue3/dist
```

---

## ğŸš€ ä¸€é”®éƒ¨ç½²

```bash
cd /home/xgs/workspace/database/data_base
bash deploy.sh
```

æˆ–ä½¿ç”¨è‡ªåŠ¨å®‰è£…nginxçš„è„šæœ¬ï¼š

```bash
bash install_and_deploy.sh
```

---

## ğŸ“ è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåï¼š

- **å‰ç«¯åº”ç”¨**: http://localhost:8080
- **åç«¯API**: http://localhost:8000
- **APIæ–‡æ¡£**: http://localhost:8000/docs

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. ç«¯å£8000è¢«å ç”¨

å¦‚æœæœ‰å…¶ä»–æœåŠ¡ï¼ˆå¦‚mineru-apiï¼‰å ç”¨8000ç«¯å£ï¼š

```bash
# åœæ­¢å ç”¨è¿›ç¨‹
sudo pkill -f mineru-api

# é‡å¯åç«¯æœåŠ¡
sudo systemctl restart photopolymer-api
```

### 2. Nginx 403 Forbidden

æ£€æŸ¥ç›®å½•æƒé™ï¼ˆå‚è§"æ–‡ä»¶æƒé™"éƒ¨åˆ†ï¼‰ã€‚

### 3. ç™»å½•404é”™è¯¯

- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`sudo systemctl status photopolymer-api`
- æŸ¥çœ‹æ—¥å¿—ï¼š`sudo journalctl -u photopolymer-api -f`

### 4. å‰ç«¯JSé”™è¯¯ï¼ˆå¾ªç¯ä¾èµ–ï¼‰

æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°æ„å»ºï¼š

```bash
cd frontend_vue3
rm -rf dist node_modules/.vite
pnpm run build
chmod -R 755 dist
sudo systemctl reload nginx
```

æµè§ˆå™¨æŒ‰ `Ctrl+Shift+R` å¼ºåˆ¶åˆ·æ–°ã€‚

---

## ğŸ”§ æœåŠ¡ç®¡ç†

### æŸ¥çœ‹çŠ¶æ€
```bash
sudo systemctl status photopolymer-api
sudo systemctl status nginx
```

### å¯åŠ¨/åœæ­¢/é‡å¯
```bash
# åç«¯
sudo systemctl start photopolymer-api
sudo systemctl stop photopolymer-api
sudo systemctl restart photopolymer-api

# å‰ç«¯
sudo systemctl restart nginx
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# åç«¯å®æ—¶æ—¥å¿—
sudo journalctl -u photopolymer-api -f

# å‰ç«¯è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/photopolymer-access.log

# å‰ç«¯é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/photopolymer-error.log
```

---

## ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®

- **åç«¯æœåŠ¡**: `backend_fastapi/depoly/photopolymer-api.service`
- **å‰ç«¯Nginx**: `frontend_vue3/depoly/photopolymer-frontend.conf`
- **éƒ¨ç½²è„šæœ¬**: `deploy.sh` æˆ– `install_and_deploy.sh`

---

## ğŸ’¡ é‡è¦æç¤º

1. âœ… è™šæ‹Ÿç¯å¢ƒè·¯å¾„ï¼š`~/venv/database/` ï¼ˆä¸åœ¨é¡¹ç›®ç›®å½•å†…ï¼‰
2. âœ… åç«¯å¯åŠ¨å‘½ä»¤ï¼š`python main.py --env=prod` ï¼ˆæ²¡æœ‰`run`å‚æ•°ï¼‰
3. âœ… å‰ç«¯ç«¯å£ï¼š8080 ï¼ˆé¿å…éœ€è¦rootæƒé™ï¼‰
4. âœ… ç¼“å­˜ç­–ç•¥ï¼šindex.htmlä¸ç¼“å­˜ï¼ŒJS/CSSé•¿æœŸç¼“å­˜

