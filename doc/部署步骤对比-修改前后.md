# éƒ¨ç½²æ­¥éª¤å¯¹æ¯” - ä¿®æ”¹å‰å

æœ¬æ–‡æ¡£å¯¹æ¯”åŸå§‹éƒ¨ç½²æ­¥éª¤å’Œä¿®æ­£åçš„éƒ¨ç½²æ­¥éª¤ï¼Œçªå‡ºæ˜¾ç¤ºå…³é”®ä¿®æ”¹ã€‚

---

## ğŸ”´ å…³é”®é”™è¯¯ä¿®æ­£

### é”™è¯¯ 1: è·¯å¾„ä¸­åŒ…å«ä¸å­˜åœ¨çš„ `data_base` ç›®å½•

| é¡¹ç›® | âŒ åŸå§‹ï¼ˆé”™è¯¯ï¼‰ | âœ… ä¿®æ­£åï¼ˆæ­£ç¡®ï¼‰ |
|------|---------------|-----------------|
| åç«¯ç›®å½• | `/home/xgs/workspace/database-bate-0.3/data_base/backend_fastapi` | `/home/xgs/workspace/database-bate-0.3/backend_fastapi` |
| å‰ç«¯ç›®å½• | `/home/xgs/workspace/database-bate-0.3/data_base/frontend_vue3` | `/home/xgs/workspace/database-bate-0.3/frontend_vue3` |

**å½±å“**ï¼šå¯¼è‡´åç«¯æœåŠ¡æ— æ³•å¯åŠ¨ï¼ˆCHDIR é”™è¯¯ï¼‰

---

### é”™è¯¯ 2: ç¼ºå°‘æ–°æœåŠ¡å™¨è·¯å¾„é…ç½®æ­¥éª¤

| é¡¹ç›® | âŒ åŸå§‹ | âœ… ä¿®æ­£å |
|------|--------|---------|
| è·¯å¾„é…ç½® | æ— æ­¤æ­¥éª¤ | æ–°å¢"ç¬¬äºŒéƒ¨åˆ†ï¼šé…ç½®è·¯å¾„" |
| é…ç½®æ–¹å¼ | æ‰‹åŠ¨ä¿®æ”¹ systemd æ–‡ä»¶ | æä¾›è‡ªåŠ¨é…ç½®è„šæœ¬ `setup_new_server.sh` |

**å½±å“**ï¼šæ–°æœåŠ¡å™¨éƒ¨ç½²æ—¶è·¯å¾„ä¸åŒ¹é…ï¼ŒæœåŠ¡æ— æ³•å¯åŠ¨

---

### é”™è¯¯ 3: æ•°æ®åº“é…ç½®ä¿¡æ¯ä¸ä¸€è‡´

| é…ç½®é¡¹ | âŒ åŸå§‹ | âœ… ä¿®æ­£å |
|--------|--------|---------|
| æ•°æ®åº“å | `photopolymer_db` | `photopolymer_formulation_db` |
| ç”¨æˆ·å | `photopolymer_user` | `photopolymer_admin` |
| å¯†ç  | `your_password_here` | `root`ï¼ˆç¤ºä¾‹ï¼Œå»ºè®®ä¿®æ”¹ï¼‰ |

**è¯´æ˜**ï¼šç»Ÿä¸€ä½¿ç”¨å®é™…åˆ›å»ºçš„æ•°æ®åº“é…ç½®

---

## ğŸ“ è¯¦ç»†å¯¹æ¯”

### ç¬¬ä¸€éƒ¨åˆ†ï¼šå®‰è£…ä¾èµ–

#### 2. åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ

**âŒ åŸå§‹æ­¥éª¤**ï¼š
```bash
cd /home/xgs/workspace/database-bate-0.3/data_base/backend_fastapi
pip install -r requirements.txt
```

**âœ… ä¿®æ­£å**ï¼š
```bash
cd ~/workspace/database-bate-0.3/backend_fastapi
pip install -r requirements.txt
```

**ä¿®æ”¹åŸå› **ï¼š
- ç§»é™¤ä¸å­˜åœ¨çš„ `data_base` ç›®å½•
- ä½¿ç”¨ `~` ä»£æ›¿ç¡¬ç¼–ç çš„ `/home/xgs`ï¼Œé€‚é…ä¸åŒç”¨æˆ·

---

#### 3. å®‰è£…å‰ç«¯ä¾èµ–

**âŒ åŸå§‹æ­¥éª¤**ï¼š
```bash
cd /home/xgs/workspace/database-bate-0.3/data_base/frontend_vue3
pnpm install
```

**âœ… ä¿®æ­£å**ï¼š
```bash
cd ~/workspace/database-bate-0.3/frontend_vue3
pnpm install
```

**ä¿®æ”¹åŸå› **ï¼šåŒä¸Š

---

### ç¬¬äºŒéƒ¨åˆ†ï¼šé…ç½®è·¯å¾„ï¼ˆæ–°å¢ï¼‰

**âœ… æ–°å¢å†…å®¹**ï¼š

```bash
# è‡ªåŠ¨é…ç½®ï¼ˆæ¨èï¼‰
cd ~/workspace/database-bate-0.3
bash setup_new_server.sh
```

**æ–°å¢åŸå› **ï¼š
- æ–°æœåŠ¡å™¨éƒ¨ç½²æ—¶ï¼Œè·¯å¾„å¯èƒ½ä¸åŒ
- æä¾›è‡ªåŠ¨åŒ–å·¥å…·ï¼Œé¿å…æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶å‡ºé”™
- æ”¯æŒäº¤äº’å¼é…ç½®ï¼Œé€‚é…ä¸åŒç¯å¢ƒ

---

### ç¬¬ä¸‰éƒ¨åˆ†ï¼šé…ç½®æ•°æ®åº“

#### 3. é…ç½®åç«¯æ•°æ®åº“è¿æ¥

**âŒ åŸå§‹æ­¥éª¤**ï¼š
```bash
cd /home/xgs/workspace/database-bate-0.3/data_base/backend_fastapi
nano app/config/settings.py
```

ä¿®æ”¹ä¸ºï¼š
```python
DATABASE_HOST: str = "localhost"
DATABASE_PORT: int = 5432
DATABASE_NAME: str = "photopolymer_db"  # âŒ ä¸å®é™…åˆ›å»ºçš„ä¸ä¸€è‡´
DATABASE_USER: str = "photopolymer_user"  # âŒ ä¸å®é™…åˆ›å»ºçš„ä¸ä¸€è‡´
DATABASE_PASSWORD: str = "your_password_here"  # âŒ å ä½ç¬¦
```

**âœ… ä¿®æ­£å**ï¼š
```bash
cd ~/workspace/database-bate-0.3/backend_fastapi
# æ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¯å¢ƒé…ç½®æ–‡ä»¶
ls env/.env.prod
# å¦‚æœå­˜åœ¨ï¼Œç¼–è¾‘é…ç½®
nano env/.env.prod
```

ä¿®æ”¹ä¸ºï¼š
```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=photopolymer_formulation_db  # âœ… ä¸åˆ›å»ºçš„æ•°æ®åº“ä¸€è‡´
DB_USER=photopolymer_admin  # âœ… ä¸åˆ›å»ºçš„ç”¨æˆ·ä¸€è‡´
DB_PASSWORD=root  # âœ… ä¸åˆ›å»ºçš„å¯†ç ä¸€è‡´
```

**ä¿®æ”¹åŸå› **ï¼š
- è·¯å¾„ä¿®æ­£
- é…ç½®ä¿¡æ¯ä¸å®é™…åˆ›å»ºçš„æ•°æ®åº“ä¸€è‡´
- ä½¿ç”¨ç¯å¢ƒé…ç½®æ–‡ä»¶è€Œéç›´æ¥ä¿®æ”¹ä»£ç 

---

### ç¬¬å››éƒ¨åˆ†ï¼šæ„å»ºå¹¶éƒ¨ç½²å‰ç«¯

#### 1. æ„å»ºå‰ç«¯

**âŒ åŸå§‹æ­¥éª¤**ï¼š
```bash
cd /home/xgs/workspace/database-bate-0.3/data_base/frontend_vue3
pnpm build
```

**âœ… ä¿®æ­£å**ï¼š
```bash
cd ~/workspace/database-bate-0.3/frontend_vue3
pnpm build
```

---

#### 2-3. é…ç½® Nginx

**âŒ åŸå§‹æ­¥éª¤**ï¼š
æ‰‹åŠ¨åˆ›å»º `/etc/nginx/sites-available/photopolymer` æ–‡ä»¶ï¼Œå†…å®¹åŒ…å«ï¼š
```nginx
root /home/xgs/workspace/database-bate-0.3/data_base/frontend_vue3/dist;
```

**âœ… ä¿®æ­£å**ï¼š
ä½¿ç”¨é¡¹ç›®ä¸­å·²æœ‰çš„é…ç½®æ–‡ä»¶ï¼š
```bash
sudo cp frontend_vue3/deploy/photopolymer-frontend.conf /etc/nginx/sites-available/photopolymer
```

é…ç½®æ–‡ä»¶å†…å®¹ï¼ˆå·²ä¿®æ­£ï¼‰ï¼š
```nginx
root /home/xgs/workspace/database-bate-0.3/frontend_vue3/dist;
proxy_pass http://localhost:8000;  # âœ… ä¿®æ­£ä¸ºåç«¯ç«¯å£
```

**ä¿®æ”¹åŸå› **ï¼š
- ä½¿ç”¨é¡¹ç›®ä¸­ç»´æŠ¤çš„é…ç½®æ–‡ä»¶ï¼Œä¾¿äºç‰ˆæœ¬æ§åˆ¶
- è·¯å¾„å·²ä¿®æ­£
- API ä»£ç†ç«¯å£å·²ä¿®æ­£ï¼ˆåŸä¸º 8080ï¼Œåº”ä¸º 8000ï¼‰

---

### ç¬¬äº”éƒ¨åˆ†ï¼šéƒ¨ç½²æœåŠ¡ï¼ˆæ–°å¢ï¼‰

**âœ… æ–°å¢å†…å®¹**ï¼š

```bash
# ä½¿ç”¨ä¸€é”®éƒ¨ç½²è„šæœ¬
cd ~/workspace/database-bate-0.3
bash update_configs.sh
```

**æ–°å¢åŸå› **ï¼š
- è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹
- å‡å°‘æ‰‹åŠ¨æ“ä½œé”™è¯¯
- è‡ªåŠ¨éªŒè¯é…ç½®å’ŒæœåŠ¡çŠ¶æ€

---

### ç¬¬å…­éƒ¨åˆ†ï¼šåˆå§‹åŒ–æ•°æ®åº“

**âŒ åŸå§‹æ­¥éª¤**ï¼š
```bash
cd /home/xgs/workspace/database-bate-0.3/data_base/backend_fastapi
# python manage.py migrate
# python manage.py createsuperuser
```

**âœ… ä¿®æ­£å**ï¼š
æ­¤æ­¥éª¤ç§»è‡³"éªŒè¯éƒ¨ç½²"éƒ¨åˆ†ï¼Œå› ä¸ºï¼š
- é¡¹ç›®å¯èƒ½æ²¡æœ‰ Django é£æ ¼çš„ `manage.py`
- æ•°æ®åº“åˆå§‹åŒ–å¯èƒ½åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨å®Œæˆ
- é¿å…è¯¯å¯¼ç”¨æˆ·æ‰§è¡Œä¸å­˜åœ¨çš„å‘½ä»¤

---

## ğŸ†• æ–°å¢åŠŸèƒ½

### 1. è‡ªåŠ¨é…ç½®è„šæœ¬

**æ–‡ä»¶**ï¼š`setup_new_server.sh`

**åŠŸèƒ½**ï¼š
- äº¤äº’å¼è¯¢é—®æœåŠ¡å™¨ä¿¡æ¯
- è‡ªåŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„è·¯å¾„
- è‡ªåŠ¨å¤‡ä»½åŸå§‹é…ç½®
- éªŒè¯ä¿®æ”¹ç»“æœ

### 2. ä¸€é”®éƒ¨ç½²è„šæœ¬

**æ–‡ä»¶**ï¼š`update_configs.sh`

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨å¤åˆ¶é…ç½®æ–‡ä»¶
- æµ‹è¯• Nginx é…ç½®
- é‡æ–°åŠ è½½æœåŠ¡
- æ˜¾ç¤ºæœåŠ¡çŠ¶æ€

### 3. è¯¦ç»†æ–‡æ¡£

**æ–°å¢æ–‡æ¡£**ï¼š
- `doc/å®Œæ•´éƒ¨ç½²æŒ‡å—.md` - å®Œæ•´çš„éƒ¨ç½²æµç¨‹
- `doc/æ–°æœåŠ¡å™¨éƒ¨ç½²è·¯å¾„ä¿®æ”¹æ¸…å•.md` - è·¯å¾„ä¿®æ”¹è¯¦ç»†è¯´æ˜
- `æ–°æœåŠ¡å™¨éƒ¨ç½²å¿«é€Ÿå‚è€ƒ.md` - å¿«é€Ÿå‚è€ƒå¡ç‰‡
- `doc/è·¯å¾„é…ç½®è¯´æ˜.md` - è·¯å¾„é…ç½®è¯¦è§£
- `PATH_CHANGES_SUMMARY.md` - è·¯å¾„ä¿®æ”¹æ€»ç»“
- `DEPLOYMENT_STEPS.md` - ç®€åŒ–çš„éƒ¨ç½²æ­¥éª¤

---

## ğŸ“Š ä¿®æ”¹ç»Ÿè®¡

| ç±»åˆ« | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| è·¯å¾„é”™è¯¯ä¿®æ­£ | 8å¤„ | ç§»é™¤ `data_base` ç›®å½•ï¼Œä¿®æ­£è·¯å¾„ |
| æ–°å¢æ­¥éª¤ | 2ä¸ª | è·¯å¾„é…ç½®ã€ä¸€é”®éƒ¨ç½² |
| æ–°å¢è„šæœ¬ | 2ä¸ª | `setup_new_server.sh`ã€`update_configs.sh` |
| æ–°å¢æ–‡æ¡£ | 6ä¸ª | è¯¦ç»†éƒ¨ç½²å’Œé…ç½®æ–‡æ¡£ |
| é…ç½®æ–‡ä»¶ä¿®æ­£ | 2ä¸ª | systemd æœåŠ¡ã€Nginx é…ç½® |

---

## âœ… æ”¹è¿›æ€»ç»“

1. **ä¿®æ­£è·¯å¾„é”™è¯¯** - ç§»é™¤ä¸å­˜åœ¨çš„ `data_base` ç›®å½•
2. **æ–°å¢è‡ªåŠ¨åŒ–å·¥å…·** - æä¾›é…ç½®å’Œéƒ¨ç½²è„šæœ¬
3. **é€‚é…æ–°æœåŠ¡å™¨** - æ”¯æŒä¸åŒç¯å¢ƒçš„è·¯å¾„é…ç½®
4. **ç»Ÿä¸€é…ç½®ä¿¡æ¯** - æ•°æ®åº“é…ç½®ä¿æŒä¸€è‡´
5. **å®Œå–„æ–‡æ¡£** - æä¾›è¯¦ç»†çš„éƒ¨ç½²å’Œæ•…éšœæ’æŸ¥æ–‡æ¡£
6. **æé«˜å¯ç»´æŠ¤æ€§** - ä½¿ç”¨é¡¹ç›®ä¸­çš„é…ç½®æ–‡ä»¶ï¼Œä¾¿äºç‰ˆæœ¬æ§åˆ¶

---

**å»ºè®®**ï¼šæ–°æœåŠ¡å™¨éƒ¨ç½²æ—¶ï¼Œè¯·ä½¿ç”¨ä¿®æ­£åçš„æ­¥éª¤ï¼Œå‚è€ƒ `DEPLOYMENT_STEPS.md` æ–‡æ¡£ã€‚
